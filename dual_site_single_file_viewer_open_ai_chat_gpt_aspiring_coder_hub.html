<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dual-Site Viewer — Single HTML File</title>
  <style>
    :root {
      --bg: #0b0f19;
      --panel: #111828;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #60a5fa;
      --border: #1f2937;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 800px at 20% -10%, rgba(96,165,250,.08), transparent 50%),
                  radial-gradient(800px 600px at 120% 10%, rgba(236,72,153,.07), transparent 40%),
                  var(--bg);
      color: var(--text);
    }
    header {
      position: sticky; top: 0; z-index: 40;
      background: linear-gradient(180deg, rgba(17,24,40,.9), rgba(17,24,40,.75));
      backdrop-filter: blur(8px);
      border-bottom: 1px solid var(--border);
    }
    .wrap { max-width: 1200px; margin: 0 auto; padding: 14px 16px; display: grid; gap: 10px; grid-template-columns: 1fr auto; align-items: center; }
    .brand { display: flex; gap: 10px; align-items: center; font-weight: 700; letter-spacing: .2px; }
    .dot { width: 8px; height: 8px; border-radius: 50%; background: linear-gradient(135deg, #60a5fa, #a78bfa); box-shadow: 0 0 10px #60a5fa77; }
    .controls { display: flex; gap: 8px; flex-wrap: wrap; }
    .control {
      background: #0d1424; border: 1px solid var(--border); color: var(--text);
      border-radius: 12px; padding: 8px 10px; font-size: 14px; outline: none;
    }
    .control.input { min-width: min(46vw, 520px); width: 38ch; }
    .btn { cursor: pointer; transition: .2s ease; }
    .btn:hover { border-color: #334155; box-shadow: 0 0 0 3px rgba(96,165,250,.1); }
    .btn.primary { background: linear-gradient(135deg, #60a5fa, #a78bfa); color: #0b0f19; border: none; font-weight: 700; }
    .btn.ghost { background: #0b1220; }
    .btn.icon { display: inline-flex; align-items: center; gap: 8px; }

    .bar { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
    .hint { color: var(--muted); font-size: 12px; }

    main { height: calc(100% - 74px); display: grid; grid-template-columns: 1fr 6px 1fr; }
    .pane { position: relative; }
    iframe { width: 100%; height: 100%; border: none; background: #0d1424; }

    .divider { background: #1f2937; cursor: col-resize; }
    .divider:hover { background: #334155; }

    .overlay {
      position: absolute; inset: 0; display: grid; place-items: center;
      pointer-events: none; padding: 16px;
    }
    .card { pointer-events: auto; max-width: 520px; background: #0b1220; border: 1px solid var(--border); border-radius: 16px; padding: 14px; }
    .card h3 { margin: 0 0 8px 0; font-size: 16px; }
    .card p { margin: 0; color: var(--muted); font-size: 13px; }
    .card .row { display: flex; gap: 8px; margin-top: 10px; }

    footer { position: fixed; right: 10px; bottom: 10px; font-size: 12px; color: var(--muted); opacity: .8; }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }

    @media (max-width: 900px) {
      .wrap { grid-template-columns: 1fr; }
      .controls { justify-content: space-between; }
      main { grid-template-columns: 1fr; grid-template-rows: 1fr 6px 1fr; height: calc(100% - 112px); }
      .divider { cursor: row-resize; }
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="brand" title="Dual-Site Viewer">
        <span class="dot"></span>
        <span>Dual‑Site Viewer</span>
      </div>
      <div class="bar">
        <input id="leftUrl" class="control input" type="url" placeholder="Left URL" />
        <input id="rightUrl" class="control input" type="url" placeholder="Right URL" />
        <button id="loadBtn" class="control btn primary">Load</button>
        <button id="swapBtn" class="control btn ghost">Swap</button>
        <button id="openLeft" class="control btn ghost icon" title="Open left in new tab">↗ Left</button>
        <button id="openRight" class="control btn ghost icon" title="Open right in new tab">↗ Right</button>
      </div>
    </div>
  </header>

  <main>
    <section class="pane" id="leftPane">
      <iframe id="leftFrame" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe>
      <div class="overlay" id="leftOverlay" hidden>
        <div class="card">
          <h3>Heads up: this site may block embedding</h3>
          <p>Some sites use <em>X‑Frame‑Options</em> or <em>Content-Security-Policy</em> to prevent loading in iframes. If the pane stays blank, use the button below to open it in a new tab.</p>
          <div class="row">
            <a id="leftOpenLink" target="_blank" rel="noopener">Open in new tab ↗</a>
          </div>
        </div>
      </div>
    </section>

    <div class="divider" id="divider"></div>

    <section class="pane" id="rightPane">
      <iframe id="rightFrame" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe>
      <div class="overlay" id="rightOverlay" hidden>
        <div class="card">
          <h3>Heads up: this site may block embedding</h3>
          <p>If the pane remains blank, click below to open the page directly.</p>
          <div class="row">
            <a id="rightOpenLink" target="_blank" rel="noopener">Open in new tab ↗</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    Single‑file viewer • Drag the divider to resize. If a site won’t load here, use the ↗ buttons.
  </footer>

  <script>
    (function(){
      const qs = (s, r=document) => r.querySelector(s);
      const leftUrl = qs('#leftUrl');
      const rightUrl = qs('#rightUrl');
      const leftFrame = qs('#leftFrame');
      const rightFrame = qs('#rightFrame');
      const loadBtn = qs('#loadBtn');
      const swapBtn = qs('#swapBtn');
      const openLeft = qs('#openLeft');
      const openRight = qs('#openRight');
      const leftOverlay = qs('#leftOverlay');
      const rightOverlay = qs('#rightOverlay');
      const leftOpenLink = qs('#leftOpenLink');
      const rightOpenLink = qs('#rightOpenLink');
      const divider = qs('#divider');

      // Defaults from your request
      const defaults = {
        left: 'https://openai.com/index/chatgpt/',
        right: 'https://preview--aspiring-coder-hub.lovable.app/'
      };

      // Load initial URLs from query params or defaults
      const params = new URLSearchParams(location.search);
      leftUrl.value = params.get('left') || defaults.left;
      rightUrl.value = params.get('right') || defaults.right;

      const setIframe = (frame, url, overlay, anchor) => {
        try {
          const u = new URL(url);
          frame.src = u.href;
          anchor.href = u.href;
          overlay.hidden = true;
          // If it doesn't paint within a bit, assume it blocks embedding
          const token = Symbol();
          frame._token = token;
          setTimeout(() => {
            if (frame._token !== token) return;
            // A best‑effort check: if contentWindow is same‑origin and has content, hide overlay
            try {
              const doc = frame.contentDocument;
              if (doc && doc.body && doc.body.children.length > 0) {
                overlay.hidden = true; return;
              }
            } catch (_) {
              /* cross‑origin — cannot inspect, so leave decision to timeout below */
            }
            overlay.hidden = false;
          }, 1800);
        } catch (e) {
          overlay.hidden = false;
        }
      };

      const loadFrames = () => {
        setIframe(leftFrame, leftUrl.value.trim(), leftOverlay, leftOpenLink);
        setIframe(rightFrame, rightUrl.value.trim(), rightOverlay, rightOpenLink);
        const q = new URLSearchParams({ left: leftUrl.value, right: rightUrl.value });
        history.replaceState({}, '', `${location.pathname}?${q.toString()}`);
      };

      loadBtn.addEventListener('click', loadFrames);
      swapBtn.addEventListener('click', () => {
        const tmp = leftUrl.value; leftUrl.value = rightUrl.value; rightUrl.value = tmp; loadFrames();
      });
      openLeft.addEventListener('click', () => window.open(leftUrl.value, '_blank', 'noopener'));
      openRight.addEventListener('click', () => window.open(rightUrl.value, '_blank', 'noopener'));

      // Resizable divider (horizontal on desktop, vertical on small screens)
      const isVertical = () => matchMedia('(max-width: 900px)').matches;
      let dragging = false;
      divider.addEventListener('pointerdown', e => { dragging = true; divider.setPointerCapture(e.pointerId); });
      divider.addEventListener('pointerup', e => { dragging = false; divider.releasePointerCapture(e.pointerId); });
      divider.addEventListener('pointermove', e => {
        if (!dragging) return;
        const root = document.querySelector('main');
        const rect = root.getBoundingClientRect();
        if (!isVertical()) {
          const x = Math.min(Math.max(e.clientX - rect.left, 120), rect.width - 120);
          const left = (x / rect.width) * 100;
          root.style.gridTemplateColumns = left + 'fr 6px ' + (100 - left) + 'fr';
        } else {
          const y = Math.min(Math.max(e.clientY - rect.top, 120), rect.height - 120);
          root.style.gridTemplateRows = y + 'px 6px calc(100% - ' + (y + 6) + 'px)';
        }
      });

      // Initial load
      loadFrames();
    })();
  </script>
</body>
</html>
